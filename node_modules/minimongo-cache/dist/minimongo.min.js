require=function t(n,e,r){function i(u,s){if(!e[u]){if(!n[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(o)return o(u,!0);throw new Error("Cannot find module '"+u+"'")}var c=e[u]={exports:{}};n[u][0].call(c.exports,function(t){var e=n[u][1][t];return i(e?e:t)},c,c.exports,t,n,e,r)}return e[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({"Focm2+":[function(t,n){"use strict";var e=t("./lib/MemoryDb");n.exports=e},{"./lib/MemoryDb":4}],minimongo:[function(t,n){n.exports=t("Focm2+")},{}],3:[function(t,n){var e=t("lodash");EJSON={};var r={};EJSON.addType=function(t,n){if(e.has(r,t))throw new Error("Type "+t+" already present");r[t]=n};var i=[{matchJSONValue:function(t){return e.has(t,"$date")&&1===e.size(t)},matchObject:function(t){return t instanceof Date},toJSONValue:function(t){return{$date:t.getTime()}},fromJSONValue:function(t){return new Date(t.$date)}},{matchJSONValue:function(t){return e.has(t,"$binary")&&1===e.size(t)},matchObject:function(t){return"undefined"!=typeof Uint8Array&&t instanceof Uint8Array||t&&e.has(t,"$Uint8ArrayPolyfill")},toJSONValue:function(t){return{$binary:EJSON._base64Encode(t)}},fromJSONValue:function(t){return EJSON._base64Decode(t.$binary)}},{matchJSONValue:function(t){return e.has(t,"$escape")&&1===e.size(t)},matchObject:function(t){return e.isEmpty(t)||e.size(t)>2?!1:e.any(i,function(n){return n.matchJSONValue(t)})},toJSONValue:function(t){var n={};return e.each(t,function(t,e){n[e]=EJSON.toJSONValue(t)}),{$escape:n}},fromJSONValue:function(t){var n={};return e.each(t.$escape,function(t,e){n[e]=EJSON.fromJSONValue(t)}),n}},{matchJSONValue:function(t){return e.has(t,"$type")&&e.has(t,"$value")&&2===e.size(t)},matchObject:function(t){return EJSON._isCustomType(t)},toJSONValue:function(t){return{$type:t.typeName(),$value:t.toJSONValue()}},fromJSONValue:function(t){var n=t.$type,e=r[n];return e(t.$value)}}];EJSON._isCustomType=function(t){return t&&"function"==typeof t.toJSONValue&&"function"==typeof t.typeName&&e.has(r,t.typeName())};var o=EJSON._adjustTypesToJSONValue=function(t){if(null===t)return null;var n=u(t);return void 0!==n?n:(e.each(t,function(n,e){if("object"==typeof n||void 0===n){var r=u(n);return r?(t[e]=r,void 0):(o(n),void 0)}}),t)},u=function(t){for(var n=0;n<i.length;n++){var e=i[n];if(e.matchObject(t))return e.toJSONValue(t)}return void 0};EJSON.toJSONValue=function(t){var n=u(t);return void 0!==n?n:("object"==typeof t&&(t=EJSON.clone(t),o(t)),t)};var s=EJSON._adjustTypesFromJSONValue=function(t){if(null===t)return null;var n=a(t);return n!==t?n:(e.each(t,function(n,e){if("object"==typeof n){var r=a(n);if(n!==r)return t[e]=r,void 0;s(n)}}),t)},a=function(t){if("object"==typeof t&&null!==t&&e.size(t)<=2&&e.all(t,function(t,n){return"string"==typeof n&&"$"===n.substr(0,1)}))for(var n=0;n<i.length;n++){var r=i[n];if(r.matchJSONValue(t))return r.fromJSONValue(t)}return t};EJSON.fromJSONValue=function(t){var n=a(t);return n===t&&"object"==typeof t?(t=EJSON.clone(t),s(t),t):n},EJSON.stringify=function(t){return JSON.stringify(EJSON.toJSONValue(t))},EJSON.parse=function(t){return EJSON.fromJSONValue(JSON.parse(t))},EJSON.isBinary=function(t){return"undefined"!=typeof Uint8Array&&t instanceof Uint8Array||t&&t.$Uint8ArrayPolyfill},EJSON.equals=function(t,n,r){var i,o=!(!r||!r.keyOrderSensitive);if(t===n)return!0;if(!t||!n)return!1;if("object"!=typeof t||"object"!=typeof n)return!1;if(t instanceof Date&&n instanceof Date)return t.valueOf()===n.valueOf();if(EJSON.isBinary(t)&&EJSON.isBinary(n)){if(t.length!==n.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==n[i])return!1;return!0}if("function"==typeof t.equals)return t.equals(n,r);if(t instanceof Array){if(!(n instanceof Array))return!1;if(t.length!==n.length)return!1;for(i=0;i<t.length;i++)if(!EJSON.equals(t[i],n[i],r))return!1;return!0}var u;if(o){var s=[];return e.each(n,function(t,n){s.push(n)}),i=0,u=e.all(t,function(t,e){return i>=s.length?!1:e!==s[i]?!1:EJSON.equals(t,n[s[i]],r)?(i++,!0):!1}),u&&i===s.length}return i=0,u=e.all(t,function(t,o){return e.has(n,o)?EJSON.equals(t,n[o],r)?(i++,!0):!1:!1}),u&&e.size(n)===i},EJSON.clone=function(t){var n;if("object"!=typeof t)return t;if(null===t)return null;if(t instanceof Date)return new Date(t.getTime());if(EJSON.isBinary(t)){n=EJSON.newBinary(t.length);for(var r=0;r<t.length;r++)n[r]=t[r];return n}if(e.isArray(t)||e.isArguments(t)){for(n=[],r=0;r<t.length;r++)n[r]=EJSON.clone(t[r]);return n}return"function"==typeof t.clone?t.clone():(n={},e.each(t,function(t,e){n[e]=EJSON.clone(t)}),n)},n.exports=EJSON},{lodash:"nJZoxB"}],4:[function(t,n){var e,r,i,o,u,s,a,c,f,l;i=t("./NullTransaction"),o=t("./WithObservableReads"),u=t("./WithObservableWrites"),s=t("./WithReactMixin"),a=t("./WithServerQuery"),l=t("lodash"),f=t("./utils"),c=t("./utils").processFind,n.exports=r=function(){function t(){this.collections={},this.transaction=this.getDefaultTransaction()}return t.prototype.getDefaultTransaction=function(){return new i},t.prototype.serialize=function(){var t,n;n={};for(t in this.collections)n[t]=this.collections[t].serialize();return n},t.deserialize=function(n){var r,i,o;o=new t;for(i in n)r=e.deserialize(o,n[i]),o.collections[i]=r,o[i]=r;return o},t.prototype.addCollection=function(t){var n;if(null==this[t])return n=new e(t,this),this[t]=n,this.collections[t]=n},t.prototype.withTransaction=function(t,n,e){var r;if(!this.transaction.canPushTransaction(t))throw new Error("Already in a transaction");r=this.transaction,this.transaction=t;try{return n.call(e)}finally{this.transaction=r}},t}(),l.mixin(r.prototype,o),l.mixin(r.prototype,u),l.mixin(r.prototype,s),l.mixin(r.prototype,a),e=function(){function t(t,n){this.name=t,this.db=n,this.items={},this.versions={},this.version=1}return t.prototype.serialize=function(){return{name:this.name,items:this.items,versions:this.versions,version:this.version}},t.deserialize=function(n,e){var r;return r=new t(e.name,n),r.items=e.items,r.versions=e.versions,r.version=e.version,r},t.prototype.find=function(t,n){return this.db.transaction.find(this.name,this._findFetch(t,n),t,n)},t.prototype.findOne=function(t,n){return this.db.transaction.findOne(this.name,this._findOne(t,n),t,n)},t.prototype._findOne=function(t,n){var e;return n=n||{},e=this._findFetch(t,n),e.length>0?e[0]:null},t.prototype._findFetch=function(t,n){return c(this.items,t,n)},t.prototype.get=function(t,n){return this.db.transaction.get(this.name,this._findOne({_id:t}),t)||n||null},t.prototype.upsert=function(t){var n,e,r,i,o,u,s,a;for(a=f.regularizeUpsert(t),r=a[0],i=a[1],o=a[2],u=0,s=r.length;s>u;u++)e=r[u],n=l.merge({},this.items[e.doc._id]||{},e.doc),this.items[e.doc._id]=n,this.version+=1,this.versions[n._id]=(this.versions[n._id]||0)+1,this.items[n._id]._version=this.versions[n._id];return this.db.transaction.upsert(this.name,t,t)},t.prototype.del=function(t){var n;return l.has(this.items,t)&&(n=this.items[t]._version,this.version+=1,this.versions[t]=n+1,delete this.items[t]),this.db.transaction.del(this.name,null,t)},t.prototype.remove=function(t,n){var e;return e=this._findFetch(t,n),e.forEach(function(t){return function(n){return t.del(n._id)}}(this))},t}()},{"./NullTransaction":5,"./WithObservableReads":6,"./WithObservableWrites":7,"./WithReactMixin":8,"./WithServerQuery":9,"./utils":11,lodash:"nJZoxB"}],5:[function(t,n){var e,r=[].slice;e=function(){function t(){}return t.prototype.get=function(){var t,n,e;return n=arguments[0],e=arguments[1],t=3<=arguments.length?r.call(arguments,2):[],e},t.prototype.find=function(){var t,n,e;return n=arguments[0],e=arguments[1],t=3<=arguments.length?r.call(arguments,2):[],e},t.prototype.findOne=function(){var t,n,e;return n=arguments[0],e=arguments[1],t=3<=arguments.length?r.call(arguments,2):[],e},t.prototype.upsert=function(){var t,n,e;throw n=arguments[0],e=arguments[1],t=3<=arguments.length?r.call(arguments,2):[],new Error("Cannot write outside of a WriteTransaction")},t.prototype.del=function(){var t,n,e;throw n=arguments[0],e=arguments[1],t=3<=arguments.length?r.call(arguments,2):[],new Error("Cannot write outside of a WriteTransaction")},t.prototype.canPushTransaction=function(){return!0},t}(),n.exports=e},{}],6:[function(t,n){var e,r,i,o,u,s={}.hasOwnProperty,a=function(t,n){function e(){this.constructor=t}for(var r in n)s.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};e=t("./NullTransaction"),u=t("lodash"),i=function(t){function n(){this.dirtyIds={},this.dirtyScans={},this.log=[]}return a(n,t),n.prototype._extractFragment=function(t){return t?{_id:t._id,_version:t._version}:null},n.prototype.get=function(t,n,e){return this.dirtyIds[t]=this.dirtyIds[t]||{},this.dirtyIds[t][e]=!0,this.log.push(this._extractFragment(n)),n},n.prototype.find=function(t,n){return this.dirtyScans[t]=!0,this.log.push(n.map(this._extractFragment)),n},n.prototype.findOne=function(t,n){return this.dirtyScans[t]=!0,this.log.push(this._extractFragment(n)),n},n.prototype.canPushTransaction=function(){return!1},n}(e),r=function(){function t(t,n,e){this.db=t,this.func=n,this.context=e,this.lastReadTransaction=null,this.lastValue=null,this.subscribers=[],this.changeListener=this.changeListener.bind(this),this.db.on("change",this.changeListener),this.rerunTransaction()}return t.prototype.subscribe=function(t){return this.subscribers.push(t),t(this.lastValue),this},t.prototype.dispose=function(){return this.db.removeListener("change",this.changeListener)},t.prototype.rerunTransaction=function(){var t,n,e;return t=new i,e=this.db.withTransaction(t,this.func,this.context),this.lastReadTransaction&&u.isEqual(this.lastReadTransaction.log,t.log)?void 0:(this.lastReadTransaction=t,n=this.lastValue,this.lastValue=e,this.subscribers.forEach(function(t){t(this.lastValue,n)},this))},t.prototype.changeListener=function(t){var n,e,r,i,o;if(!this.lastReadTransaction)return this.rerunTransaction(),void 0;for(n in t){if(this.lastReadTransaction.dirtyScans[n])return this.rerunTransaction(),void 0;for(e=this.lastReadTransaction.dirtyIds[n]||{},i=t[n],o=0;o<i.length;){if(r=i[o],e[r._id])return this.rerunTransaction(),void 0;o++}}},t}(),o={observe:function(t,n){return new r(this,t,n)}},n.exports=o},{"./NullTransaction":5,lodash:"nJZoxB"}],7:[function(t,n){(function(e){var r,i,o,u,s,a={}.hasOwnProperty,c=function(t,n){function e(){this.constructor=t}for(var r in n)a.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};r=t("eventemitter3"),i=t("./NullTransaction"),s=t("lodash"),u=function(t){function n(t){this.db=t,this.dirtyIds={},this.queued=!1}return c(n,t),n.prototype._ensureQueued=function(){return this.queued?void 0:(this.queued=!0,e.nextTick(function(t){return function(){return t._flush()}}(this)))},n.prototype.upsert=function(t,n,e){return Array.isArray(e)||(e=[e]),this.dirtyIds[t]=this.dirtyIds[t]||{},e.forEach(function(n){return function(e){return n.dirtyIds[t][e._id]=!0}}(this)),this._ensureQueued(),n},n.prototype.del=function(t,n,e){return this.dirtyIds[t]=this.dirtyIds[t]||{},this.dirtyIds[t][e]=!0,this._ensureQueued(),n},n.prototype.canPushTransaction=function(){return!0},n.prototype._flush=function(){var t,n,e,r,i,o,u;t={},u=this.dirtyIds;for(n in u){i=u[n],e=[];for(r in i)o=this.db.collections[n].versions[r],e.push({_id:r,_version:o});t[n]=e}return this.dirtyIds={},this.queued=!1,this.db.emit("change",t)},n}(i),o={getDefaultTransaction:function(){return this.setMaxListeners(0),new u(this)}},s.mixin(o,r.prototype),n.exports=o}).call(this,t("FWaASH"))},{"./NullTransaction":5,FWaASH:14,eventemitter3:15,lodash:"nJZoxB"}],8:[function(t,n){var e,r;r=function(t){var n;return n={componentWillMount:function(){return this.subscription=null,this.prevData=null,this.data={},null!=this.shouldComponentUpdate&&(this._userShouldComponentUpdate=this.shouldComponentUpdate,this.shouldComponentUpdate=this._shouldComponentUpdate),this._refresh()},_shouldComponentUpdate:function(t,n,e){var r;r=this.data,this.data=this.prevData;try{return this._userShouldComponentUpdate(t,n,r,e)}finally{this.data=r,this.prevData=this.data}},_refresh:function(){return this.subscription&&this.subscription.dispose(),this.subscription=t.observe(this.observeData),this.subscription.subscribe(this._setData)},_setData:function(t,n){return this.prevData=this.data,this.data=t,n?this.setState({}):void 0},componentWillUpdate:function(t,n){var e,r;e=this.props,r=this.state,this.props=t,this.state=n;try{return this._refresh()}finally{this.props=e,this.state=r}},componentWillUnmount:function(){return this.subscription?this.subscription.dispose():void 0}}},e={getReactMixin:function(){return null==this.mixin&&(this.mixin=r(this)),this.mixin}},n.exports=e},{}],9:[function(t,n){var e,r;r=t("lodash"),e={createServerQuery:function(t){var n,e;if(null==t.query)throw new Error("You must pass a query method");if(null==t.fetchIfNeeded)throw new Error("You must pass a fetchIfNeeded method");return e=this,n=function(){function t(t){this.args=t}return t.prototype.observe=function(){var t;return this.fetchIfNeeded(),t=e.observe(function(t){return function(){return t.query()}}(this)),t.subscribe(this.fetchIfNeeded.bind(this))},t}(),r.mixin(n.prototype,t),function(t){var e;return e=new n(t),e.observe()}}},n.exports=e},{lodash:"nJZoxB"}],10:[function(t,n,e){LocalCollection={},EJSON=t("./EJSON");var r=t("lodash"),i=function(t){return r.isArray(t)&&!EJSON.isBinary(t)},o=function(t,n){return i(t)?r.any(t,n):n(t)},u=function(t,n){return n(t)?!0:i(t)&&r.any(t,n)},s=function(t){var n=void 0;for(var e in t){var r="$"===e.substr(0,1);if(void 0===n)n=r;else if(n!==r)throw new Error("Inconsistent selector: "+t)}return!!n},a=function(t){if(null==t)return function(t){return o(t,function(t){return null==t})};if(!r.isObject(t))return function(n){return o(n,function(n){return n===t})};if(t instanceof RegExp)return function(n){return void 0===n?!1:o(n,function(n){return t.test(n)})};if(i(t))return function(n){return i(n)?u(n,function(n){return LocalCollection._f._equal(t,n)}):!1};if(s(t)){var n=[];return r.each(t,function(e,i){if(!r.has(f,i))throw new Error("Unrecognized operator: "+i);n.push(f[i](e,t.$options))}),function(t){return r.all(n,function(n){return n(t)})}}return function(n){return o(n,function(n){return LocalCollection._f._equal(t,n)})}},c={$and:function(t){if(!i(t)||r.isEmpty(t))throw Error("$and/$or/$nor must be nonempty array");var n=r.map(t,l);return function(t){return r.all(n,function(n){return n(t)})}},$or:function(t){if(!i(t)||r.isEmpty(t))throw Error("$and/$or/$nor must be nonempty array");var n=r.map(t,l);return function(t){return r.any(n,function(n){return n(t)})}},$nor:function(t){if(!i(t)||r.isEmpty(t))throw Error("$and/$or/$nor must be nonempty array");var n=r.map(t,l);return function(t){return r.all(n,function(n){return!n(t)})}},$where:function(t){return t instanceof Function||(t=Function("return "+t)),function(n){return t.call(n)}}},f={$in:function(t){if(!i(t))throw new Error("Argument to $in must be array");return function(n){return u(n,function(n){return r.any(t,function(t){return LocalCollection._f._equal(t,n)})})}},$all:function(t){if(!i(t))throw new Error("Argument to $all must be array");return function(n){return i(n)?r.all(t,function(t){return r.any(n,function(n){return LocalCollection._f._equal(t,n)})}):!1}},$lt:function(t){return function(n){return o(n,function(n){return LocalCollection._f._cmp(n,t)<0})}},$lte:function(t){return function(n){return o(n,function(n){return LocalCollection._f._cmp(n,t)<=0})}},$gt:function(t){return function(n){return o(n,function(n){return LocalCollection._f._cmp(n,t)>0})}},$gte:function(t){return function(n){return o(n,function(n){return LocalCollection._f._cmp(n,t)>=0})}},$ne:function(t){return function(n){return!u(n,function(n){return LocalCollection._f._equal(n,t)})}},$nin:function(t){if(!i(t))throw new Error("Argument to $nin must be array");var n=f.$in(t);return function(t){return void 0===t?!0:!n(t)}},$exists:function(t){return function(n){return t===(void 0!==n)}},$mod:function(t){var n=t[0],e=t[1];return function(t){return o(t,function(t){return t%n===e})}},$size:function(t){return function(n){return i(n)&&t===n.length}},$type:function(t){return function(n){return void 0===n?!1:o(n,function(n){return LocalCollection._f._type(n)===t})}},$regex:function(t,n){if(void 0!==n){if(/[^gim]/.test(n))throw new Error("Only the i, m, and g regexp options are supported");var e=t instanceof RegExp?t.source:t;t=new RegExp(e,n)}else t instanceof RegExp||(t=new RegExp(t));return function(n){return void 0===n?!1:o(n,function(n){return t.test(n)})}},$options:function(){return function(){return!0}},$elemMatch:function(t){var n=l(t);return function(t){return i(t)?r.any(t,function(t){return n(t)}):!1}},$not:function(t){var n=a(t);return function(t){return!n(t)}},$near:function(){return function(){return!0}},$geoIntersects:function(){return function(){return!0}}};LocalCollection._f={_type:function(t){return"number"==typeof t?1:"string"==typeof t?2:"boolean"==typeof t?8:i(t)?4:null===t?10:t instanceof RegExp?11:"function"==typeof t?13:t instanceof Date?9:EJSON.isBinary(t)?5:t instanceof Meteor.Collection.ObjectID?7:3},_equal:function(t,n){return EJSON.equals(t,n,{keyOrderSensitive:!0})},_typeorder:function(t){return[-1,1,2,3,4,5,-1,6,7,8,0,9,-1,100,2,100,1,8,1][t]},_cmp:function(t,n){if(void 0===t)return void 0===n?0:-1;if(void 0===n)return 1;var e=LocalCollection._f._type(t),r=LocalCollection._f._type(n),i=LocalCollection._f._typeorder(e),o=LocalCollection._f._typeorder(r);if(i!==o)return o>i?-1:1;if(e!==r)throw Error("Missing type coercion logic in _cmp");if(7===e&&(e=r=2,t=t.toHexString(),n=n.toHexString()),9===e&&(e=r=1,t=t.getTime(),n=n.getTime()),1===e)return t-n;if(2===r)return n>t?-1:t===n?0:1;if(3===e){var u=function(t){var n=[];for(var e in t)n.push(e),n.push(t[e]);return n};return LocalCollection._f._cmp(u(t),u(n))}if(4===e)for(var s=0;;s++){if(s===t.length)return s===n.length?0:-1;if(s===n.length)return 1;var a=LocalCollection._f._cmp(t[s],n[s]);if(0!==a)return a}if(5===e){if(t.length!==n.length)return t.length-n.length;for(s=0;s<t.length;s++){if(t[s]<n[s])return-1;if(t[s]>n[s])return 1}return 0}if(8===e)return t?n?0:1:n?-1:0;if(10===e)return 0;if(11===e)throw Error("Sorting not supported on regular expression");if(13===e)throw Error("Sorting not supported on Javascript code");throw Error("Unknown type to sort")}},LocalCollection._matches=function(t,n){return LocalCollection._compileSelector(t)(n)},LocalCollection._makeLookupFunction=function(t){var n,e,o,u=t.indexOf(".");if(-1===u)n=t;else{n=t.substr(0,u);var s=t.substr(u+1);e=LocalCollection._makeLookupFunction(s),o=/^\d+(\.|$)/.test(s)}return function(t){if(null==t)return[void 0];var u=t[n];return e?i(u)&&0===u.length?[void 0]:((!i(u)||o)&&(u=[u]),Array.prototype.concat.apply([],r.map(u,e))):[u]}};var l=function(t){var n=[];return r.each(t,function(t,e){if("$"===e.substr(0,1)){if(!r.has(c,e))throw new Error("Unrecognized logical operator: "+e);n.push(c[e](t))}else{var i=LocalCollection._makeLookupFunction(e),o=a(t);n.push(function(t){var n=i(t);return r.any(n,o)})}}),function(t){return r.all(n,function(n){return n(t)})}};LocalCollection._compileSelector=function(t){if(t instanceof Function)return function(n){return t.call(n)};if(LocalCollection._selectorIsId(t))return function(n){return EJSON.equals(n._id,t)};if(!t||"_id"in t&&!t._id)return function(){return!1};if("boolean"==typeof t||i(t)||EJSON.isBinary(t))throw new Error("Invalid selector: "+t);return l(t)},LocalCollection._compileSort=function(t){var n=[];if(t instanceof Array)for(var e=0;e<t.length;e++)"string"==typeof t[e]?n.push({lookup:LocalCollection._makeLookupFunction(t[e]),ascending:!0}):n.push({lookup:LocalCollection._makeLookupFunction(t[e][0]),ascending:"desc"!==t[e][1]});else{if("object"!=typeof t)throw Error("Bad sort specification: ",JSON.stringify(t));for(var o in t)n.push({lookup:LocalCollection._makeLookupFunction(o),ascending:t[o]>=0})}if(0===n.length)return function(){return 0};var u=function(t,n){var e,o=!0;return r.each(t,function(t){i(t)||(t=[t]),i(t)&&0===t.length&&(t=[void 0]),r.each(t,function(t){if(o)e=t,o=!1;else{var r=LocalCollection._f._cmp(e,t);(n&&r>0||!n&&0>r)&&(e=t)}})}),e};return function(t,e){for(var r=0;r<n.length;++r){var i=n[r],o=u(i.lookup(t),i.ascending),s=u(i.lookup(e),i.ascending),a=LocalCollection._f._cmp(o,s);if(0!==a)return i.ascending?a:-a}return 0}},e.compileDocumentSelector=l,e.compileSort=LocalCollection._compileSort},{"./EJSON":3,lodash:"nJZoxB"}],11:[function(t,n,e){var r,i,o,u,s,a,c,f;f=t("lodash"),r=t("./selector").compileDocumentSelector,i=t("./selector").compileSort,e.compileDocumentSelector=r,e.processFind=function(t,n,o){var u;return u=f.filter(f.values(t),r(n)),u=c(n,u),u=a(n,u),o&&o.sort&&u.sort(i(o.sort)),o&&o.skip&&(u=f.rest(u,o.skip)),o&&o.limit&&(u=f.first(u,o.limit)),o&&o.fields&&(u=e.filterFields(u,o.fields)),u},e.filterFields=function(t,n){return null==n&&(n={}),0===f.keys(n).length?t:f.map(t,function(t){var e,r,i,o,u,s,a,c,l,h,p,d,v,y,m,g,_,x,b,w,O;if(i={},1===f.first(f.values(n))){for(x=f.keys(n).concat(["_id"]),c=0,d=x.length;d>c;c++){for(e=x[c],u=e.split("."),o=t,l=0,v=u.length;v>l;l++)s=u[l],o&&(o=o[s]);if(null!=o){for(r=t,a=i,b=f.initial(u),h=0,y=b.length;y>h;h++)s=b[h],a[s]=a[s]||{},a=a[s],r=r[s];a[f.last(u)]=r[f.last(u)]}}return i}for(w=f.keys(n).concat(["_id"]),p=0,m=w.length;m>p;p++){for(e=w[p],u=e.split("."),o=t,O=f.initial(u),_=0,g=O.length;g>_;_++)s=O[_],o&&(o=o[s]);null!=o&&delete o[f.last(u)]}return t})},e.createUid=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var n,e;return n=16*Math.random()|0,e="x"===t?n:3&n|8,e.toString(16)})},c=function(t,n){var e,r,i,o;for(i in t)if(o=t[i],null!=o&&o.$near){if(r=o.$near.$geometry,"Point"!==r.type)break;n=f.filter(n,function(t){return t[i]&&"Point"===t[i].type}),e=f.map(n,function(t){return{doc:t,distance:u(r.coordinates[1],r.coordinates[0],t[i].coordinates[1],t[i].coordinates[0])}}),e=f.filter(e,function(t){return t.distance>=0}),e=f.sortBy(e,"distance"),o.$near.$maxDistance&&(e=f.filter(e,function(t){return t.distance<=o.$near.$maxDistance})),e=f.first(e,100),n=f.pluck(e,"doc")}return n},s=function(t,n){if(!f.isEqual(f.first(n.coordinates[0]),f.last(n.coordinates[0])))throw new Error("First must equal last");return t.coordinates[0]<Math.min.apply(this,f.map(n.coordinates[0],function(t){return t[0]}))?!1:t.coordinates[1]<Math.min.apply(this,f.map(n.coordinates[0],function(t){return t[1]}))?!1:t.coordinates[0]>Math.max.apply(this,f.map(n.coordinates[0],function(t){return t[0]}))?!1:t.coordinates[1]>Math.max.apply(this,f.map(n.coordinates[0],function(t){return t[1]}))?!1:!0},u=function(t,n,e,r){var i,u,s,a,c,f;return i=6370986,c=o(e-t),f=o(r-n),u=Math.sin(c/2)*Math.sin(c/2)+Math.cos(o(t))*Math.cos(o(e))*Math.sin(f/2)*Math.sin(f/2),s=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),a=i*s},o=function(t){return t*(Math.PI/180)},a=function(t,n){var e,r,i;for(r in t)if(i=t[r],null!=i&&i.$geoIntersects){if(e=i.$geoIntersects.$geometry,"Polygon"!==e.type)break;n=f.filter(n,function(t){return t[r]&&"Point"===t[r].type?s(t[r],e):!1})}return n},e.regularizeUpsert=function(t,n,e,r){var i,o,u,s,a;for(f.isFunction(n)&&(a=[void 0,n,e],n=a[0],e=a[1],r=a[2]),f.isArray(t)?n=n||[]:(t=[t],n=[n]),o=f.map(t,function(t,e){return{doc:t,base:e<n.length?n[e]:void 0}}),u=0,s=o.length;s>u;u++)if(i=o[u],null==i.doc._id)throw new Error("All documents in the upsert must have an _id");return[o,e,r]}},{"./selector":10,lodash:"nJZoxB"}],lodash:[function(t,n){n.exports=t("nJZoxB")},{}],nJZoxB:[function(t,n){n.exports=window._},{}],14:[function(t,n){function e(){}var r=n.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(n){var e=[];return window.addEventListener("message",function(t){var n=t.source;if((n===window||null===n)&&"process-tick"===t.data&&(t.stopPropagation(),e.length>0)){var r=e.shift();r()}},!0),function(t){e.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=e,r.addListener=e,r.once=e,r.off=e,r.removeListener=e,r.removeAllListeners=e,r.emit=e,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},{}],15:[function(t,n){"use strict";function e(t,n,e){this.fn=t,this.context=n,this.once=e||!1}function r(){}var i="function"!=typeof Object.create?"~":!1;r.prototype._events=void 0,r.prototype.listeners=function(t,n){var e=i?i+t:t,r=this._events&&this._events[e];if(n)return!!r;if(!r)return[];if(this._events[e].fn)return[this._events[e].fn];for(var o=0,u=this._events[e].length,s=new Array(u);u>o;o++)s[o]=this._events[e][o].fn;return s},r.prototype.emit=function(t,n,e,r,o,u){var s=i?i+t:t;if(!this._events||!this._events[s])return!1;var a,c,f=this._events[s],l=arguments.length;if("function"==typeof f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,n),!0;case 3:return f.fn.call(f.context,n,e),!0;case 4:return f.fn.call(f.context,n,e,r),!0;case 5:return f.fn.call(f.context,n,e,r,o),!0;case 6:return f.fn.call(f.context,n,e,r,o,u),!0}for(c=1,a=new Array(l-1);l>c;c++)a[c-1]=arguments[c];f.fn.apply(f.context,a)}else{var h,p=f.length;for(c=0;p>c;c++)switch(f[c].once&&this.removeListener(t,f[c].fn,void 0,!0),l){case 1:f[c].fn.call(f[c].context);break;case 2:f[c].fn.call(f[c].context,n);break;case 3:f[c].fn.call(f[c].context,n,e);break;default:if(!a)for(h=1,a=new Array(l-1);l>h;h++)a[h-1]=arguments[h];f[c].fn.apply(f[c].context,a)}}return!0},r.prototype.on=function(t,n,r){var o=new e(n,r||this),u=i?i+t:t;return this._events||(this._events=i?{}:Object.create(null)),this._events[u]?this._events[u].fn?this._events[u]=[this._events[u],o]:this._events[u].push(o):this._events[u]=o,this},r.prototype.once=function(t,n,r){var o=new e(n,r||this,!0),u=i?i+t:t;return this._events||(this._events=i?{}:Object.create(null)),this._events[u]?this._events[u].fn?this._events[u]=[this._events[u],o]:this._events[u].push(o):this._events[u]=o,this},r.prototype.removeListener=function(t,n,e,r){var o=i?i+t:t;if(!this._events||!this._events[o])return this;var u=this._events[o],s=[];if(n)if(u.fn)(u.fn!==n||r&&!u.once||e&&u.context!==e)&&s.push(u);else for(var a=0,c=u.length;c>a;a++)(u[a].fn!==n||r&&!u[a].once||e&&u[a].context!==e)&&s.push(u[a]);return s.length?this._events[o]=1===s.length?s[0]:s:delete this._events[o],this},r.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[i?i+t:t]:this._events=i?{}:Object.create(null),this):this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=i,n.exports=r},{}]},{},[]);